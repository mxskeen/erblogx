name: Keep Backend Alive


on:
  schedule:
    # Runs every 3 hours (at minute 0 of hours 0, 3, 6, 9, 12, 15, 18, 21)
    - cron: '0 */3 * * *'
  
  # Allow manual triggering for testing
  workflow_dispatch:

jobs:
  ping-backend:
    runs-on: ubuntu-latest
    
    steps:
      - name: Ping Hugging Face Space Backend
        run: |
          echo " Pinging ErBlogX backend to keep it alive..."
          
          echo " Testing AI search endpoint (1/4)..."
          curl -f -s -w "Status: %{http_code}, Time: %{time_total}s\n" \
            "https://maskeen-erblogx.hf.space/ai-search?q=how%20to%20use%20ai%20apps" > /dev/null && echo "âœ… AI search 1 successful" || echo "âŒ AI search 1 failed"
          
          echo "ğŸ” Testing AI search endpoint (2/4)..."
          curl -f -s -w "Status: %{http_code}, Time: %{time_total}s\n" \
            "https://maskeen-erblogx.hf.space/ai-search?q=programming%20tutorials" > /dev/null && echo "âœ… AI search 2 successful" || echo "âŒ AI search 2 failed"
          
          echo "ğŸ” Testing AI search endpoint (3/4)..."
          curl -f -s -w "Status: %{http_code}, Time: %{time_total}s\n" \
            "https://maskeen-erblogx.hf.space/ai-search?q=web%20development" > /dev/null && echo "âœ… AI search 3 successful" || echo "âŒ AI search 3 failed"
          
          echo "ğŸ” Testing AI search endpoint (4/4)..."
          curl -f -s -w "Status: %{http_code}, Time: %{time_total}s\n" \
            "https://maskeen-erblogx.hf.space/ai-search?q=machine%20learning" > /dev/null && echo "âœ… AI search 4 successful" || echo "âŒ AI search 4 failed"
          
          # Ping the root endpoint
          echo "ğŸ  Testing root endpoint..."
          curl -f -s -w "Status: %{http_code}, Time: %{time_total}s\n" \
            "https://maskeen-erblogx.hf.space/" > /dev/null && echo "âœ… Root endpoint successful" || echo "âŒ Root endpoint failed"
          
          echo "âœ… Backend ping completed at $(date)"
      
      - name: Log Status
        run: |
          echo "ğŸ¯ Keep-alive job completed successfully"
